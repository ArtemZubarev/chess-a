!function(){"use strict";var oe="abcdefgh".split("");function ae(e){if("string"!=typeof e)return!1;var n=e.split("-");return 2===n.length&&(!0===ie(n[0])&&!0===ie(n[1]))}function ie(e){return"string"==typeof e&&-1!==e.search(/^[a-h][1-8]$/)}function se(e){if("string"!=typeof e)return!1;var n=(e=e.replace(/ .+$/,"")).split("/");if(8!==n.length)return!1;for(var r=0;r<8;r++)if(""===n[r]||8<n[r].length||-1!==n[r].search(/[^kqrbnpKQRNBP1-8]/))return!1;return!0}function pe(e){if("object"!=typeof e)return!1;for(var n in e)if(!0===e.hasOwnProperty(n)&&(!0!==ie(n)||!0!=("string"==typeof(r=e[n])&&-1!==r.search(/^[bw][KQRNBP]$/))))return!1;var r;return!0}function ce(e){if(!0!==se(e))return!1;for(var n,r=(e=e.replace(/ .+$/,"")).split("/"),t={},o=8,a=0;a<8;a++){for(var i=r[a].split(""),s=0,p=0;p<i.length;p++){if(-1!==i[p].search(/[1-8]/))s+=parseInt(i[p],10);else t[oe[s]+o]=(n=i[p]).toLowerCase()===n?"b"+n.toUpperCase():"w"+n.toUpperCase(),s++}o--}return t}function fe(e){if(!0!==pe(e))return!1;for(var n,r,t="",o=8,a=0;a<8;a++){for(var i=0;i<8;i++){var s=oe[i]+o;!0===e.hasOwnProperty(s)?t+=(n=e[s],r=void 0,"w"===(r=n.split(""))[0]?r[1].toUpperCase():r[1].toLowerCase()):t+="1"}7!==a&&(t+="/"),o--}return t=(t=(t=(t=(t=(t=(t=t.replace(/11111111/g,"8")).replace(/1111111/g,"7")).replace(/111111/g,"6")).replace(/11111/g,"5")).replace(/1111/g,"4")).replace(/111/g,"3")).replace(/11/g,"2")}window.ChessBoard=window.ChessBoard||function(n,u){u=u||{};var r,t,a,o,i,p,s,c,f,d,h="1.7.0",l=ce("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),v={alpha:"alpha-d2270",black:"black-3c85d",board:"board-b72b1",chessboard:"chessboard-63f37",clearfix:"clearfix-7da63",highlight1:"highlight1-32417",highlight2:"highlight2-9c5d2",notation:"notation-322f9",numeric:"numeric-fc462",piece:"piece-417db",row:"row-5277c",sparePieces:"spare-pieces-7492f",sparePiecesBottom:"spare-pieces-bottom-ae20f",sparePiecesTop:"spare-pieces-top-4028b",square:"square-55d63",white:"white-1e1d7"},g={},w=2,m="white",y={},b=!1,P={},O={};function x(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(e){return(16*Math.random()|0).toString(16)})}function S(e){return JSON.parse(JSON.stringify(e))}function E(e){var n=e.split(".");return{major:parseInt(n[0],10),minor:parseInt(n[1],10),patch:parseInt(n[2],10)}}function k(e,n,r){if(!0===u.hasOwnProperty("showErrors")&&!1!==u.showErrors){var t="ChessBoard Error "+e+": "+n;return"console"===u.showErrors&&"object"==typeof console&&"function"==typeof console.log?(console.log(t),void(2<=arguments.length&&console.log(r))):"alert"===u.showErrors?(r&&(t+="\n\n"+JSON.stringify(r)),void window.alert(t)):void("function"==typeof u.showErrors&&u.showErrors(e,n,r))}}function e(){if("string"==typeof n){if(""===n)return window.alert("ChessBoard Error 1001: The first argument to ChessBoard() cannot be an empty string.\n\nExiting..."),!1;var e=document.getElementById(n);if(!e)return window.alert('ChessBoard Error 1002: Element with id "'+n+'" does not exist in the DOM.\n\nExiting...'),!1;r=$(e)}else if(1!==(r=$(n)).length)return window.alert("ChessBoard Error 1003: The first argument to ChessBoard() must be an ID or a single DOM node.\n\nExiting..."),!1;return window.JSON&&"function"==typeof JSON.stringify&&"function"==typeof JSON.parse?(window.$,!(!$.fn||!$.fn.jquery||!0!==function(e,n){e=E(e),n=E(n);var r=1e4*e.major*1e4+1e4*e.minor+e.patch;return 1e4*n.major*1e4+1e4*n.minor+n.patch<=r}($.fn.jquery,h))||(window.alert("ChessBoard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+h+" or higher on the page.\n\nExiting..."),!1)):(window.alert("ChessBoard Error 1004: JSON does not exist. Please include a JSON polyfill.\n\nExiting..."),!1)}function q(e){return"fast"===e||"slow"===e||parseInt(e,10)+""==e+""&&0<=e}function B(e){return"function"==typeof u.pieceTheme?u.pieceTheme(e):"string"==typeof u.pieceTheme?u.pieceTheme.replace(/{piece}/g,e):(k(8272,"Unable to build image source for cfg.pieceTheme."),"")}function C(e,n,r){var t='<img src="'+B(e)+'" ';return r&&"string"==typeof r&&(t+='id="'+r+'" '),t+='alt="" class="'+v.piece+'" data-piece="'+e+'" style="width: '+p+"px;height: "+p+"px;",!0===n&&(t+="display:none;"),t+='" />'}function T(e){var n=["wK","wQ","wR","wB","wN","wP"];"black"===e&&(n=["bK","bQ","bR","bB","bN","bP"]);for(var r="",t=0;t<n.length;t++)r+=C(n[t],!1,P[n[t]]);return r}function N(e,n,r,t){var o=$("#"+O[e]),a=o.offset(),i=$("#"+O[n]),s=i.offset(),p=x();$("body").append(C(r,!0,p));var c=$("#"+p);c.css({display:"",position:"absolute",top:a.top,left:a.left}),o.find("."+v.piece).remove();var f={duration:u.moveSpeed,complete:function(){i.append(C(r)),c.remove(),"function"==typeof t&&t()}};c.animate(s,f)}function I(e,n,r){var t=$("#"+P[e]).offset(),o=$("#"+O[n]),a=o.offset(),i=x();$("body").append(C(e,!0,i));var s=$("#"+i);s.css({display:"",position:"absolute",left:t.left,top:t.top});var p={duration:u.moveSpeed,complete:function(){o.find("."+v.piece).remove(),o.append(C(e)),s.remove(),"function"==typeof r&&r()}};s.animate(a,p)}function M(e,n){e=e.split("");var r=oe.indexOf(e[0])+1,t=parseInt(e[1],10);n=n.split("");var o=oe.indexOf(n[0])+1,a=parseInt(n[1],10),i=Math.abs(r-o),s=Math.abs(t-a);return s<=i?i:s}function D(e,n,r){for(var t=function(e){for(var n=[],r=0;r<8;r++)for(var t=0;t<8;t++){var o=oe[r]+(t+1);e!==o&&n.push({square:o,distance:M(e,o)})}n.sort(function(e,n){return e.distance-n.distance});var a=[];for(r=0;r<n.length;r++)a.push(n[r].square);return a}(r),o=0;o<t.length;o++){var a=t[o];if(!0===e.hasOwnProperty(a)&&e[a]===n)return a}return!1}function j(){for(var e in t.find("."+v.piece).remove(),y)!0===y.hasOwnProperty(e)&&$("#"+O[e]).append(C(y[e]))}function J(){t.html(function(e){"black"!==e&&(e="white");var n="",r=S(oe),t=8;"black"===e&&(r.reverse(),t=1);for(var o="white",a=0;a<8;a++){n+='<div class="'+v.row+'">';for(var i=0;i<8;i++){var s=r[i]+t;n+='<div class="'+v.square+" "+v[o]+" square-"+s+'" style="width: '+p+"px; height: "+p+'px" id="'+O[s]+'" data-square="'+s+'">',!0===u.showNotation&&(("white"===e&&1===t||"black"===e&&8===t)&&(n+='<div class="'+v.notation+" "+v.alpha+'">'+r[i]+"</div>"),0===i&&(n+='<div class="'+v.notation+" "+v.numeric+'">'+t+"</div>")),n+="</div>",o="white"===o?"black":"white"}n+='<div class="'+v.clearfix+'"></div></div>',o="white"===o?"black":"white","white"===e?t--:t++}return n}(m)),j(),!0===u.sparePieces&&("white"===m?(o.html(T("black")),i.html(T("white"))):(o.html(T("white")),i.html(T("black"))))}function Q(e){var n=S(y),r=S(e);fe(n)!==fe(r)&&(!0===u.hasOwnProperty("onChange")&&"function"==typeof u.onChange&&u.onChange(n,r),y=e)}function X(e,n){for(var r in d)if(!0===d.hasOwnProperty(r)){var t=d[r];if(e>=t.left&&e<t.left+p&&n>=t.top&&n<t.top+p)return r}return"offboard"}function Y(){t.find("."+v.square).removeClass(v.highlight1+" "+v.highlight2)}function R(){Y();var e=S(y);delete e[f],Q(e),j(),a.fadeOut(u.trashSpeed),b=!1}function K(e,n,r,t){"function"==typeof u.onDragStart&&!1===u.onDragStart(e,n,S(y),m)||(b=!0,s=n,c="spare"===(f=e)?"offboard":e,function(){for(var e in d={},O)!0===O.hasOwnProperty(e)&&(d[e]=$("#"+O[e]).offset())}(),a.attr("src",B(n)).css({display:"",position:"absolute",left:r-p/2,top:t-p/2}),"spare"!==e&&$("#"+O[e]).addClass(v.highlight1).find("."+v.piece).css("display","none"))}function L(e,n){a.css({left:e-p/2,top:n-p/2});var r=X(e,n);r!==c&&(!0===ie(c)&&$("#"+O[c]).removeClass(v.highlight2),!0===ie(r)&&$("#"+O[r]).addClass(v.highlight2),"function"==typeof u.onDragMove&&u.onDragMove(r,c,f,s,S(y),m),c=r)}function U(e){var n="drop";if("offboard"===e&&"snapback"===u.dropOffBoard&&(n="snapback"),"offboard"===e&&"trash"===u.dropOffBoard&&(n="trash"),!0===u.hasOwnProperty("onDrop")&&"function"==typeof u.onDrop){var r=S(y);"spare"===f&&!0===ie(e)&&(r[e]=s),!0===ie(f)&&"offboard"===e&&delete r[f],!0===ie(f)&&!0===ie(e)&&(delete r[f],r[e]=s);var t=S(y),o=u.onDrop(f,e,s,r,t,m);"snapback"!==o&&"trash"!==o||(n=o)}"snapback"===n?function(){if("spare"!==f){Y();var e=$("#"+O[f]).offset(),n={duration:u.snapbackSpeed,complete:function(){j(),a.css("display","none"),!0===u.hasOwnProperty("onSnapbackEnd")&&"function"==typeof u.onSnapbackEnd&&u.onSnapbackEnd(s,f,S(y),m)}};a.animate(e,n),b=!1}else R()}():"trash"===n?R():"drop"===n&&function(e){Y();var n=S(y);delete n[f],n[e]=s,Q(n);var r=$("#"+O[e]).offset(),t={duration:u.snapSpeed,complete:function(){j(),a.css("display","none"),!0===u.hasOwnProperty("onSnapEnd")&&"function"==typeof u.onSnapEnd&&u.onSnapEnd(f,e,s)}};a.animate(r,t),b=!1}(e)}function _(e){e.preventDefault()}function z(e){if(!0===u.draggable){var n=$(this).attr("data-square");!0===ie(n)&&!0===y.hasOwnProperty(n)&&K(n,y[n],e.pageX,e.pageY)}}function A(e){if(!0===u.draggable){var n=$(this).attr("data-square");!0===ie(n)&&!0===y.hasOwnProperty(n)&&(e=e.originalEvent,K(n,y[n],e.changedTouches[0].pageX,e.changedTouches[0].pageY))}}function G(e){!0===u.sparePieces&&K("spare",$(this).attr("data-piece"),e.pageX,e.pageY)}function W(e){!0===u.sparePieces&&K("spare",$(this).attr("data-piece"),(e=e.originalEvent).changedTouches[0].pageX,e.changedTouches[0].pageY)}function F(e){!0===b&&L(e.pageX,e.pageY)}function H(e){!0===b&&(e.preventDefault(),L(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function V(e){!0===b&&U(X(e.pageX,e.pageY))}function Z(e){!0===b&&U(X(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function ee(e){if(!1===b&&!0===u.hasOwnProperty("onMouseoverSquare")&&"function"==typeof u.onMouseoverSquare){var n=$(e.currentTarget).attr("data-square");if(!0===ie(n)){var r=!1;!0===y.hasOwnProperty(n)&&(r=y[n]),u.onMouseoverSquare(n,r,S(y),m)}}}function ne(e){if(!1===b&&!0===u.hasOwnProperty("onMouseoutSquare")&&"function"==typeof u.onMouseoutSquare){var n=$(e.currentTarget).attr("data-square");if(!0===ie(n)){var r=!1;!0===y.hasOwnProperty(n)&&(r=y[n]),u.onMouseoutSquare(n,r,S(y),m)}}}function re(){$("body").on("mousedown mousemove","."+v.piece,_),t.on("mousedown","."+v.square,z),r.on("mousedown","."+v.sparePieces+" ."+v.piece,G),t.on("mouseenter","."+v.square,ee),t.on("mouseleave","."+v.square,ne),!0===(navigator&&navigator.userAgent&&-1!==navigator.userAgent.search(/MSIE/))?(document.ondragstart=function(){return!1},$("body").on("mousemove",F),$("body").on("mouseup",V)):($(window).on("mousemove",F),$(window).on("mouseup",V)),"ontouchstart"in document.documentElement==!0&&(t.on("touchstart","."+v.square,A),r.on("touchstart","."+v.sparePieces+" ."+v.piece,W),$(window).on("touchmove",H),$(window).on("touchend",Z))}function te(){r.html(function(){var e='<div class="'+v.chessboard+'">';return!0===u.sparePieces&&(e+='<div class="'+v.sparePieces+" "+v.sparePiecesTop+'"></div>'),e+='<div class="'+v.board+'"></div>',!0===u.sparePieces&&(e+='<div class="'+v.sparePieces+" "+v.sparePiecesBottom+'"></div>'),e+="</div>"}()),t=r.find("."+v.board),!0===u.sparePieces&&(o=r.find("."+v.sparePiecesTop),i=r.find("."+v.sparePiecesBottom));var e=x();$("body").append(C("wP",!0,e)),a=$("#"+e),w=parseInt(t.css("borderLeftWidth"),10),g.resize()}return g.clear=function(e){g.position({},e)},g.destroy=function(){r.html(""),a.remove(),r.unbind()},g.fen=function(){return g.position("fen")},g.flip=function(){g.orientation("flip")},g.move=function(){if(0!==arguments.length){for(var e=!0,n={},r=0;r<arguments.length;r++)if(!1!==arguments[r])if(!0===ae(arguments[r])){var t=arguments[r].split("-");n[t[0]]=t[1]}else k(2826,"Invalid move passed to the move method.",arguments[r]);else e=!1;var o=function(e,n){for(var r in e=S(e),n)if(!0===n.hasOwnProperty(r)&&!0===e.hasOwnProperty(r)){var t=e[r];delete e[r],e[n[r]]=t}return e}(y,n);return g.position(o,e),o}},g.orientation=function(e){return 0===arguments.length?m:"white"===e||"black"===e?(m=e,void J()):"flip"===e?(m="white"===m?"black":"white",void J()):void k(5482,"Invalid value passed to the orientation method.",e)},g.position=function(e,n){return 0===arguments.length?S(y):"string"==typeof e&&"fen"===e.toLowerCase()?fe(y):(!1!==n&&(n=!0),"string"==typeof e&&"start"===e.toLowerCase()&&(e=S(l)),!0===se(e)&&(e=ce(e)),void(!0===pe(e)?!0===n?(function(e,n,r){!0;var t=0;function o(){++t===e.length&&(j(),!!1===u.hasOwnProperty("onMoveEnd")&&"function"==typeof u.onMoveEnd&&u.onMoveEnd(S(n),S(r)))}for(var a=0;a<e.length;a++)"clear"===e[a].type&&$("#"+O[e[a].square]+" ."+v.piece).fadeOut(u.trashSpeed,o),"add"===e[a].type&&!0!==u.sparePieces&&$("#"+O[e[a].square]).append(C(e[a].piece,!0)).find("."+v.piece).fadeIn(u.appearSpeed,o),"add"===e[a].type&&!0===u.sparePieces&&I(e[a].piece,e[a].square,o),"move"===e[a].type&&N(e[a].source,e[a].destination,e[a].piece,o)}(function(e,n){e=S(e),n=S(n);var r=[],t={};for(var o in n)!0===n.hasOwnProperty(o)&&!0===e.hasOwnProperty(o)&&e[o]===n[o]&&(delete e[o],delete n[o]);for(var o in n)if(!0===n.hasOwnProperty(o)){var a=D(e,n[o],o);!1!==a&&(r.push({type:"move",source:a,destination:o,piece:n[o]}),delete e[a],delete n[o],t[o]=!0)}for(var o in n)!0===n.hasOwnProperty(o)&&(r.push({type:"add",square:o,piece:n[o]}),delete n[o]);for(var o in e)!0===e.hasOwnProperty(o)&&!0!==t.hasOwnProperty(o)&&(r.push({type:"clear",square:o,piece:e[o]}),delete e[o]);return r}(y,e),y,e),Q(e)):(Q(e),j()):k(6482,"Invalid value passed to the position method.",e)))},g.resize=function(){p=function(){var e=parseInt(r.css("width"),10);if(!e||e<=0)return 0;for(var n=e-1;n%8!=0&&0<n;)n--;return n/8}(),t.css("width",8*p+"px"),a.css({height:p,width:p}),!0===u.sparePieces&&r.find("."+v.sparePieces).css("paddingLeft",p+w+"px"),J()},g.start=function(e){g.position("start",e)},!0===e()&&1==("string"!=typeof u&&!0!==pe(u)||(u={position:u}),"black"!==u.orientation&&(u.orientation="white"),m=u.orientation,!1!==u.showNotation&&(u.showNotation=!0),!0!==u.draggable&&(u.draggable=!1),"trash"!==u.dropOffBoard&&(u.dropOffBoard="snapback"),!0!==u.sparePieces&&(u.sparePieces=!1),!0===u.sparePieces&&(u.draggable=!0),(!0!==u.hasOwnProperty("pieceTheme")||"string"!=typeof u.pieceTheme&&"function"!=typeof u.pieceTheme)&&(u.pieceTheme="img/{piece}.png"),!0===u.hasOwnProperty("appearSpeed")&&!0===q(u.appearSpeed)||(u.appearSpeed=200),!0===u.hasOwnProperty("moveSpeed")&&!0===q(u.moveSpeed)||(u.moveSpeed=200),!0===u.hasOwnProperty("snapbackSpeed")&&!0===q(u.snapbackSpeed)||(u.snapbackSpeed=50),!0===u.hasOwnProperty("snapSpeed")&&!0===q(u.snapSpeed)||(u.snapSpeed=25),!0===u.hasOwnProperty("trashSpeed")&&!0===q(u.trashSpeed)||(u.trashSpeed=100),!0===u.hasOwnProperty("position")&&("start"===u.position?y=S(l):!0===se(u.position)?y=ce(u.position):!0===pe(u.position)?y=S(u.position):k(7263,"Invalid value passed to config.position.",u.position)),!0)&&(function(){for(var e=0;e<oe.length;e++)for(var n=1;n<=8;n++){var r=oe[e]+n;O[r]=r+"-"+x()}var t="KQRBNP".split("");for(e=0;e<t.length;e++){var o="w"+t[e],a="b"+t[e];P[o]=o+"-"+x(),P[a]=a+"-"+x()}}(),te(),re()),g},window.ChessBoard.fenToObj=ce,window.ChessBoard.objToFen=fe}();var e=null,o=new Chess,r=$("#status"),t=$("#fen"),a=$("#pgn");function i(){var e="",n="White";"b"===o.turn()&&(n="Black"),o.in_checkmate()?e="Game over, "+n+" is in checkmate.":o.in_draw()?e="Game over, drawn position":(e=n+" to move",o.in_check()&&(e+=", "+n+" is in check")),r.html(e),t.html(o.fen()),a.html(o.pgn())}e=ChessBoard("board1",{draggable:!0,position:"start",onDragStart:function(e,n,r,t){return!o.game_over()&&(!("w"===o.turn()&&-1!==n.search(/^b/)||"b"===o.turn()&&-1!==n.search(/^w/))&&void 0)},onDrop:function(e,n){if(null===o.move({from:e,to:n,promotion:"q"}))return"snapback";i()},onSnapEnd:function(){e.position(o.fen())}}),i();